<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <title>file api test</title>
    </head>
    <body>
        <input type="file" id="files" name="files[]" multiple />
        <output id="list"></output>

        <!--
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js"></script>
        -->
        <script>
//
//


if (typeof String.prototype.f !== 'function') {
    String.prototype.f = function() {
        var args = arguments;
        var index = 1;
        var replace = function() {
            return args[index++];
        };
        return this.replace(/%s/g, replace);
    };
}
var getOnload = function(theFile) {
    return (function(e) {
        var span = document.createElement('span');
        span.innerHTML = '<img class="img" src="%s" title="%s" />'.f(e.target.result, escape(theFile.name));
        document.getElementById('list').insertBefore(span, null);
    });
};
var handleFileSelect = function(evt) {
    var files = evt.target.files;
    var output = [];
    var i = 0;
    var n = files.length;
    var f;
    while (f = files[i++]) {
        if (!f.type.match('image.*')) {
            continue;
        }
        var reader = new FileReader();
        reader.onload = getOnload(f);
        reader.readAsDataURL(f);
    }
};

document.getElementById('files').addEventListener('change', handleFileSelect, false);
        </script>
    </body>
</html>
